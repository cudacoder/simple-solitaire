{"version":3,"file":"game.js","sources":["../node_modules/style-inject/dist/style-inject.es.js","../src/main.js"],"sourcesContent":["function styleInject(css, ref) {\n  if ( ref === void 0 ) ref = {};\n  var insertAt = ref.insertAt;\n\n  if (!css || typeof document === 'undefined') { return; }\n\n  var head = document.head || document.getElementsByTagName('head')[0];\n  var style = document.createElement('style');\n  style.type = 'text/css';\n\n  if (insertAt === 'top') {\n    if (head.firstChild) {\n      head.insertBefore(style, head.firstChild);\n    } else {\n      head.appendChild(style);\n    }\n  } else {\n    head.appendChild(style);\n  }\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    style.appendChild(document.createTextNode(css));\n  }\n}\n\nexport default styleInject;\n","/*\r\n * TODO:\r\n * - Make each cards interactable\r\n * - Render the cards in the correct spots using the tableaus somehow\r\n * - Check collision on all of the shown cards, and then test for tableau, then for hidden\r\n */\r\n\r\nimport './styles/solitaire.css';\r\n\r\nconst CARD_WIDTH = 500;\r\nconst CARD_HEIGHT = 726;\r\nconst CARD_SIZE_X = CARD_WIDTH / 6;\r\nconst CARD_SIZE_Y = CARD_HEIGHT / 6;\r\nconst CANVAS_WIDTH = document.documentElement.clientWidth;\r\nconst CANVAS_HEIGHT = document.documentElement.clientHeight;\r\nconst SUITS_TO_COLORS = ['black', 'red', 'red', 'black']\r\n\r\nconst Sprites = new Image();\r\nconst GameState = { elements: { foundations: [], tableaus: [], cards: [], deck: null } , player: {} };\r\n\r\nconst canvas = document.getElementById('game');\r\n/** @type CanvasRenderingContext2D */\r\nconst ctx = canvas.getContext('2d');\r\n\r\ncanvas.onmouseup = function(e) { handleMouseUp(e); };\r\ncanvas.onmousedown = function(e) { handleMouseDown(e); };\r\ncanvas.onmousemove = function(e) { handleMouseMove(e); };\r\n\r\ncanvas.width = CANVAS_WIDTH;\r\ncanvas.height = CANVAS_HEIGHT;\r\ncanvas.style.width = CANVAS_WIDTH;\r\ncanvas.style.height = CANVAS_HEIGHT;\r\n\r\nSprites.onload = setup;\r\nSprites.src = 'cards-spritesheet.png';\r\n\r\nlet lastMousePoint;\r\nlet isDown = false;\r\nlet draggedCard = null;\r\n\r\nArray.prototype.random = function() {\r\n\tlet randomIndex = Math.floor(Math.random() * this.length);\r\n\treturn [randomIndex, this[randomIndex]];\r\n};\r\n\r\nArray.prototype.last = function() {\r\n\treturn this[this.length - 1];\r\n};\r\n\r\nfunction isColliding(rect1, rect2) {\r\n\tif (rect1.point.x < rect2.point.x + rect2.width &&\r\n\t\trect1.point.x + rect1.width > rect2.point.x &&\r\n\t\trect1.point.y < rect2.point.y + rect2.height &&\r\n\t\trect1.point.y + rect1.height > rect2.point.y) {\r\n\t\treturn true;\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nfunction getMousePos(canvas, evt) {\r\n\tlet rect = canvas.getBoundingClientRect();\r\n\treturn new Point(evt.clientX - rect.left, evt.clientY - rect.top);\r\n}\r\n\r\nfunction isClicked(mousePoint, element) {\r\n\tlet heightHit = mousePoint.y > element.point.y && mousePoint.y < element.point.y + element.height;\r\n\tlet widthHit = mousePoint.x > element.point.x && mousePoint.x < element.point.x + element.width;\r\n\treturn heightHit && widthHit;\r\n}\r\n\r\nfunction Point(x,y) {\r\n\tthis.x = x;\r\n\tthis.y = y;\r\n\tthis.translate = (xAmount, yAmount) => {\r\n\t\tthis.x += xAmount;\r\n\t\tthis.y += yAmount;\r\n\t}\r\n}\r\n\r\nfunction Deck(point) {\r\n\tthis.cards = [];\r\n\tthis.point = point;\r\n\tthis.width = CARD_SIZE_X;\r\n\tthis.height = CARD_SIZE_Y;\r\n\tthis.reset = () => {\r\n\t\tGameState.elements.cards = [...this.cards];\r\n\t\tthis.cards = [];\r\n\t};\r\n\tthis.remove = card => {\r\n\t\tthis.cards.splice(this.cards.indexOf(card), 1);\r\n\t};\r\n\tthis.push = card => {\r\n\t\tcard.parent = this;\r\n\t\tcard.hidden = false;\r\n\t\tcard.point = new Point(this.point.x + CARD_SIZE_X + 50, this.point.y);\r\n\t\tcard.origPoint = Object.assign({}, card.point);\r\n\t\tthis.cards.push(card);\r\n\t};\r\n\tthis.draw = () => {\r\n\t\tctx.save();\r\n\t\tctx.fillStyle = 'yellow';\r\n\t\tctx.strokeStyle = 'white';\r\n\t\tctx.fillRect(this.point.x, this.point.y, CARD_SIZE_X, CARD_SIZE_Y);\r\n\t\tctx.strokeRect(this.point.x, this.point.y, CARD_SIZE_X, CARD_SIZE_Y);\r\n\t\tctx.restore();\r\n\t};\r\n}\r\n\r\nfunction Card(number, suit, point = {x: 0, y: 0}) {\r\n\tthis.children = [];\r\n\tthis.parent = {};\r\n\tthis.suit = suit;\r\n\tthis.point = point;\r\n\tthis.origPoint = {};\r\n\tthis.color = SUITS_TO_COLORS[suit];\r\n\tthis.width = CARD_SIZE_X;\r\n\tthis.height = CARD_SIZE_Y;\r\n\tthis.number = number;\r\n\tthis.hidden = true;\r\n\tthis.reset = () => {\r\n\t\tthis.point = Object.assign({}, this.origPoint);\r\n\t}\r\n\tthis.draw = () => {\r\n\t\tctx.save();\r\n\t\tif (!this.hidden) {\r\n\t\t\tctx.drawImage(Sprites, this.suit * CARD_WIDTH, (this.number - 1) * CARD_HEIGHT, CARD_WIDTH, CARD_HEIGHT, this.point.x, this.point.y, CARD_SIZE_X, CARD_SIZE_Y);\r\n\t\t} else {\r\n\t\t\tctx.fillStyle = 'orange';\r\n\t\t\tctx.strokeStyle = 'white';\r\n\t\t\tctx.fillRect(this.point.x, this.point.y, CARD_SIZE_X, CARD_SIZE_Y);\r\n\t\t\tctx.strokeRect(this.point.x, this.point.y, CARD_SIZE_X, CARD_SIZE_Y);\r\n\t\t}\r\n\t\tctx.restore();\r\n\t};\r\n}\r\n\r\nfunction Foundation(point, suit) {\r\n\tthis.suit = suit;\r\n\tthis.nextNumber = 1;\r\n\tthis.cards = [];\r\n\tthis.width = CARD_SIZE_X + 5;\r\n\tthis.height = CARD_SIZE_Y + 5;\r\n\tthis.point = Object.assign({}, point);\r\n\tthis.isPushable = card => this.suit === card.suit && this.nextNumber === card.number;\r\n\tthis.push = card => {\r\n\t\tthis.nextNumber += 1;\r\n\t\tcard.point = new Point(this.point.x, this.point.y);\r\n\t\tcard.origPoint = Object.assign({}, card.point);\r\n\t\tthis.cards.push(card);\r\n\t};\r\n\tthis.draw = () => {\r\n\t\tctx.save();\r\n\t\tif (this.cards.length === 0) {\r\n\t\t\tctx.fillStyle = 'darkblue';\r\n\t\t\tctx.fillRect(this.point.x, this.point.y, this.width, this.height);\r\n\t\t} else {\r\n\t\t\tthis.cards.forEach(c => c.draw());\r\n\t\t}\r\n\t\tctx.restore();\r\n\t}\r\n};\r\n\r\nfunction Tableau(point) {\r\n\tthis.cards = [];\r\n\tthis.point = Object.assign({}, point);\r\n\tthis.width = CARD_SIZE_X;\r\n\tthis.isPushable = card => {\r\n\t\tif (this.cards.length === 0 && card.number === 13) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\treturn this.topCard.color !== card.color && this.topCard.number === card.number + 1;\r\n\t};\r\n\tthis.push = card => {\r\n\t\tcard.point = new Point(this.point.x, this.point.y + (25 * this.cards.length));\r\n\t\tcard.origPoint = Object.assign({}, card.point);\r\n\t\tcard.parent = this;\r\n\t\tthis.cards.push(card);\r\n\t};\r\n\tthis.remove = card => {\r\n\t\tthis.cards.splice(this.cards.indexOf(card), 1);\r\n\t};\r\n\tthis.draw = () => {\r\n\t\tctx.save();\r\n\t\tctx.strokeStyle = 'white';\r\n\t\tctx.strokeRect(this.point.x, this.point.y, this.width, CARD_SIZE_Y);\r\n\t\tthis.cards.forEach(c => c.draw());\r\n\t\tctx.restore();\r\n\t};\r\n\tthis.showCard = () => {\r\n\t\tthis.topCard.hidden = false;\r\n\t};\r\n\tObject.defineProperty(this, 'topCard', {\r\n\t\tget() {\r\n\t\t\treturn this.cards[this.cards.length - 1];\r\n\t\t}\r\n\t});\r\n\tObject.defineProperty(this, 'height', {\r\n\t\tget() {\r\n\t\t\treturn this.cards.length * 25 + CARD_SIZE_Y;\r\n\t\t}\r\n\t});\r\n}\r\n\r\nfunction setup() {\r\n\tconst nextFoundationPoint = new Point(250, 10);\r\n\tconst nextTableauPoint = new Point(CANVAS_WIDTH / 12, CANVAS_HEIGHT / 2.8)\r\n\r\n\t// Cards\r\n\tfor (let i = 0; i < 4; i++) {\r\n\t\tfor (let j = 0; j < 13; j++) {\r\n\t\t\tGameState.elements.cards.push(new Card(j + 1, i));\r\n\t\t}\r\n\t}\r\n\r\n\t// Foundations\r\n\tfor (let i = 0; i < 4; i++) {\r\n\t\tlet f = new Foundation(nextFoundationPoint, i);\r\n\t\tGameState.elements.foundations.push(f);\r\n\t\tnextFoundationPoint.translate(140, 0);\r\n\t}\r\n\r\n\t// Tableaus\r\n\tfor (let i = 0; i < 7; i++) {\r\n\t\tlet t = new Tableau(nextTableauPoint);\r\n\t\tfor (let j = 0; j < i + 1; j++) {\r\n\t\t\tlet [index, randomCard] = GameState.elements.cards.random();\r\n\t\t\trandomCard.hidden = j !== i;\r\n\t\t\tGameState.elements.cards.splice(index, 1);\r\n\t\t\tt.push(randomCard);\r\n\t\t}\r\n\t\tGameState.elements.tableaus.push(t);\r\n\t\tnextTableauPoint.translate(CARD_SIZE_X + 30, 0);\r\n\t}\r\n\r\n\t// Deck\r\n\tlet deckPos = new Point(CANVAS_WIDTH - (CANVAS_WIDTH - 70), CANVAS_HEIGHT - 200);\r\n\tGameState.elements.deck = new Deck(deckPos);\r\n\r\n\tdraw();\r\n}\r\n\r\nfunction draw() {\r\n\tctx.clearRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);\r\n\tGameState.elements.foundations.forEach(f => f.draw());\r\n\tGameState.elements.tableaus.forEach(t => t.draw());\r\n\tGameState.elements.deck.draw();\r\n\tGameState.elements.deck.cards.forEach(c => c.draw());\r\n}\r\n\r\nfunction handleMouseDown(e) {\r\n\te.preventDefault();\r\n\te.stopPropagation();\r\n\r\n\tlastMousePoint = getMousePos(canvas, e);\r\n\r\n\tGameState.elements.tableaus.forEach(t => {\r\n\t\tif (isClicked(lastMousePoint, t) && t.cards.length > 0){\r\n\t\t\tlet topCard = t.cards.last(); \r\n\t\t\tif (topCard.hidden) {\r\n\t\t\t\tt.showCard();\r\n\t\t\t}\r\n\t\t\tdraggedCard = topCard;\r\n\t\t}\r\n\t});\r\n\r\n\t// Deck cards check\r\n\tGameState.elements.deck.cards.forEach( c => {\r\n\t\tif (isClicked(lastMousePoint, c)) {\r\n\t\t\tdraggedCard = c;\r\n\t\t}\r\n\t});\r\n\r\n\t// Deck click check\r\n\tif (isClicked(lastMousePoint, GameState.elements.deck)) {\r\n\t\tif (GameState.elements.cards.length === 0) {\r\n\t\t\tGameState.elements.deck.reset();\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tGameState.elements.deck.push(GameState.elements.cards.pop());\r\n\t}\r\n\r\n\tisDown = true;\r\n}\r\n\r\nfunction handleMouseMove(e) {\r\n\tif (!isDown || !draggedCard) { return; }\r\n\r\n\te.preventDefault();\r\n\te.stopPropagation();\r\n\r\n\tlet mousePoint = getMousePos(canvas, e);\r\n\r\n\tlet dx = mousePoint.x - lastMousePoint.x;\r\n\tlet dy = mousePoint.y - lastMousePoint.y;\r\n\r\n\tlastMousePoint = new Point(mousePoint.x, mousePoint.y);\r\n\r\n\tdraggedCard.point.x += dx;\r\n\tdraggedCard.point.y += dy;\r\n\r\n\tdraw();\r\n}\r\n\r\nfunction handleMouseUp(e) {\r\n\te.preventDefault();\r\n\te.stopPropagation();\r\n\r\n\tlet hitElement;\r\n\r\n\tif (draggedCard) {\r\n\t\thitElement = GameState.elements.foundations.find(f => isColliding(draggedCard, f));\r\n\t\thitElement = !hitElement ? GameState.elements.tableaus.find(t => isColliding(draggedCard, t)) : hitElement;\r\n\t\tif (hitElement && hitElement.isPushable(draggedCard)) {\r\n\t\t\tdraggedCard.parent.remove(draggedCard);\r\n\t\t\thitElement.push(draggedCard);\r\n\t\t} else {\r\n\t\t\tdraggedCard.reset();\r\n\t\t}\r\n\t\tdraggedCard = null;\r\n\t}\r\n\r\n\tisDown = false;\r\n\r\n\tdraw();\r\n}\r\n"],"names":["styleInject","css","ref","insertAt","document","head","getElementsByTagName","style","createElement","type","firstChild","insertBefore","appendChild","styleSheet","cssText","createTextNode","CARD_WIDTH","CARD_HEIGHT","CARD_SIZE_X","CARD_SIZE_Y","CANVAS_WIDTH","documentElement","clientWidth","CANVAS_HEIGHT","clientHeight","SUITS_TO_COLORS","Sprites","Image","GameState","elements","foundations","tableaus","cards","deck","player","canvas","getElementById","ctx","getContext","onmouseup","e","handleMouseUp","onmousedown","handleMouseDown","onmousemove","handleMouseMove","width","height","onload","setup","src","lastMousePoint","isDown","draggedCard","Array","prototype","random","randomIndex","Math","floor","length","last","isColliding","rect1","rect2","point","x","y","getMousePos","evt","rect","getBoundingClientRect","Point","clientX","left","clientY","top","isClicked","mousePoint","element","heightHit","widthHit","translate","xAmount","yAmount","Deck","reset","remove","card","splice","indexOf","push","parent","hidden","origPoint","Object","assign","draw","save","fillStyle","strokeStyle","fillRect","strokeRect","restore","Card","number","suit","children","color","drawImage","Foundation","nextNumber","isPushable","forEach","c","Tableau","topCard","showCard","defineProperty","get","nextFoundationPoint","nextTableauPoint","i","j","f","t","index","randomCard","deckPos","clearRect","preventDefault","stopPropagation","pop","dx","dy","hitElement","find"],"mappings":"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"}